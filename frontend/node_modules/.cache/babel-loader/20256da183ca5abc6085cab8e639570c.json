{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SVGmaction = void 0;\n\nvar Wrapper_js_1 = require(\"../Wrapper.js\");\n\nvar maction_js_1 = require(\"../../common/Wrappers/maction.js\");\n\nvar maction_js_2 = require(\"../../common/Wrappers/maction.js\");\n\nvar maction_js_3 = require(\"../../../core/MmlTree/MmlNodes/maction.js\");\n\nvar SVGmaction = function (_super) {\n  __extends(SVGmaction, _super);\n\n  function SVGmaction() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SVGmaction.prototype.toSVG = function (parent) {\n    var svg = this.standardSVGnode(parent);\n    var child = this.selected;\n\n    var _a = child.getBBox(),\n        h = _a.h,\n        d = _a.d,\n        w = _a.w;\n\n    this.adaptor.append(this.element, this.svg('rect', {\n      width: this.fixed(w),\n      height: this.fixed(h + d),\n      y: this.fixed(-d),\n      fill: 'none',\n      'pointer-events': 'all'\n    }));\n    child.toSVG(svg);\n    this.action(this, this.data);\n  };\n\n  SVGmaction.prototype.setEventHandler = function (type, handler) {\n    this.element.addEventListener(type, handler);\n  };\n\n  SVGmaction.kind = maction_js_3.MmlMaction.prototype.kind;\n  SVGmaction.styles = {\n    '[jax=\"SVG\"] mjx-tool': {\n      display: 'inline-block',\n      position: 'relative',\n      width: 0,\n      height: 0\n    },\n    '[jax=\"SVG\"] mjx-tool > mjx-tip': {\n      position: 'absolute',\n      top: 0,\n      left: 0\n    },\n    'mjx-tool > mjx-tip': {\n      display: 'inline-block',\n      padding: '.2em',\n      border: '1px solid #888',\n      'font-size': '70%',\n      'background-color': '#F8F8F8',\n      color: 'black',\n      'box-shadow': '2px 2px 5px #AAAAAA'\n    },\n    'g[data-mml-node=\"maction\"][data-toggle]': {\n      cursor: 'pointer'\n    },\n    'mjx-status': {\n      display: 'block',\n      position: 'fixed',\n      left: '1em',\n      bottom: '1em',\n      'min-width': '25%',\n      padding: '.2em .4em',\n      border: '1px solid #888',\n      'font-size': '90%',\n      'background-color': '#F8F8F8',\n      color: 'black'\n    }\n  };\n  SVGmaction.actions = new Map([['toggle', [function (node, _data) {\n    node.adaptor.setAttribute(node.element, 'data-toggle', node.node.attributes.get('selection'));\n    var math = node.factory.jax.math;\n    var document = node.factory.jax.document;\n    var mml = node.node;\n    node.setEventHandler('click', function (event) {\n      if (!math.end.node) {\n        math.start.node = math.end.node = math.typesetRoot;\n        math.start.n = math.end.n = 0;\n      }\n\n      mml.nextToggleSelection();\n      math.rerender(document);\n      event.stopPropagation();\n    });\n  }, {}]], ['tooltip', [function (node, data) {\n    var tip = node.childNodes[1];\n    if (!tip) return;\n    var rect = node.firstChild();\n\n    if (tip.node.isKind('mtext')) {\n      var text = tip.node.getText();\n      node.adaptor.insert(node.svg('title', {}, [node.text(text)]), rect);\n    } else {\n      var adaptor_1 = node.adaptor;\n      var container_1 = node.jax.container;\n      var math = node.node.factory.create('math', {}, [node.childNodes[1].node]);\n      var tool_1 = node.html('mjx-tool', {}, [node.html('mjx-tip')]);\n      var hidden_1 = adaptor_1.append(rect, node.svg('foreignObject', {\n        style: {\n          display: 'none'\n        }\n      }, [tool_1]));\n      node.jax.processMath(math, adaptor_1.firstChild(tool_1));\n      node.childNodes[1].node.parent = node.node;\n      node.setEventHandler('mouseover', function (event) {\n        data.stopTimers(node, data);\n        data.hoverTimer.set(node, setTimeout(function () {\n          adaptor_1.setStyle(tool_1, 'left', '0');\n          adaptor_1.setStyle(tool_1, 'top', '0');\n          adaptor_1.append(container_1, tool_1);\n          var tbox = adaptor_1.nodeBBox(tool_1);\n          var nbox = adaptor_1.nodeBBox(node.element);\n          var dx = (nbox.right - tbox.left) / node.metrics.em + node.dx;\n          var dy = (nbox.bottom - tbox.bottom) / node.metrics.em + node.dy;\n          adaptor_1.setStyle(tool_1, 'left', node.px(dx));\n          adaptor_1.setStyle(tool_1, 'top', node.px(dy));\n        }, data.postDelay));\n        event.stopPropagation();\n      });\n      node.setEventHandler('mouseout', function (event) {\n        data.stopTimers(node, data);\n        var timer = setTimeout(function () {\n          return adaptor_1.append(hidden_1, tool_1);\n        }, data.clearDelay);\n        data.clearTimer.set(node, timer);\n        event.stopPropagation();\n      });\n    }\n  }, maction_js_2.TooltipData]], ['statusline', [function (node, data) {\n    var tip = node.childNodes[1];\n    if (!tip) return;\n\n    if (tip.node.isKind('mtext')) {\n      var adaptor_2 = node.adaptor;\n      var text_1 = tip.node.getText();\n      adaptor_2.setAttribute(node.element, 'data-statusline', text_1);\n      node.setEventHandler('mouseover', function (event) {\n        if (data.status === null) {\n          var body = adaptor_2.body(adaptor_2.document);\n          data.status = adaptor_2.append(body, node.html('mjx-status', {}, [node.text(text_1)]));\n        }\n\n        event.stopPropagation();\n      });\n      node.setEventHandler('mouseout', function (event) {\n        if (data.status) {\n          adaptor_2.remove(data.status);\n          data.status = null;\n        }\n\n        event.stopPropagation();\n      });\n    }\n  }, {\n    status: null\n  }]]]);\n  return SVGmaction;\n}(maction_js_1.CommonMactionMixin(Wrapper_js_1.SVGWrapper));\n\nexports.SVGmaction = SVGmaction;","map":{"version":3,"mappings":"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","names":["__extends","SVGmaction","parent","svg","standardSVGnode","child","selected","getBBox","h","d","w","adaptor","append","element","width","fixed","height","y","fill","toSVG","action","data","type","handler","addEventListener","maction_js_3","prototype","kind","display","position","top","left","padding","border","color","cursor","bottom","Map","node","_data","setAttribute","attributes","get","math","factory","jax","document","mml","setEventHandler","event","end","start","typesetRoot","n","nextToggleSelection","rerender","stopPropagation","tip","childNodes","rect","firstChild","isKind","text","getText","insert","adaptor_1","container_1","container","create","tool_1","html","hidden_1","style","processMath","stopTimers","hoverTimer","set","setTimeout","setStyle","tbox","nodeBBox","nbox","dx","right","metrics","em","dy","px","postDelay","timer","clearDelay","clearTimer","maction_js_2","adaptor_2","text_1","status","body","remove","maction_js_1","Wrapper_js_1","exports"],"sources":["/home/kinzoku99/Desktop/ProjectIO/frontend/node_modules/mathjax-full/ts/output/svg/Wrappers/maction.ts"],"sourcesContent":["/*************************************************************\n *\n *  Copyright (c) 2018-2021 The MathJax Consortium\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\n/**\n * @fileoverview  Implements the SVGmaction wrapper for the MmlMaction object\n *\n * @author dpvc@mathjax.org (Davide Cervone)\n */\n\nimport {SVGWrapper, SVGConstructor} from '../Wrapper.js';\nimport {CommonMactionMixin} from '../../common/Wrappers/maction.js';\nimport {ActionDef} from '../../common/Wrappers/maction.js';\nimport {EventHandler, TooltipData} from '../../common/Wrappers/maction.js';\nimport {MmlMaction} from '../../../core/MmlTree/MmlNodes/maction.js';\nimport {TextNode, AbstractMmlNode} from '../../../core/MmlTree/MmlNode.js';\nimport {StyleList} from '../../../util/StyleList.js';\n\n/*****************************************************************/\n/**\n * The SVGmaction wrapper for the MmlMaction object\n *\n * @template N  The HTMLElement node class\n * @template T  The Text node class\n * @template D  The Document class\n */\n// @ts-ignore\nexport class SVGmaction<N, T, D> extends\nCommonMactionMixin<SVGWrapper<any, any, any>, SVGConstructor<any, any, any>>(SVGWrapper) {\n\n  /**\n   * The maction wrapper\n   */\n  public static kind = MmlMaction.prototype.kind;\n\n  /**\n   * @override\n   */\n  public static styles: StyleList = {\n    '[jax=\"SVG\"] mjx-tool': {\n      display: 'inline-block',\n      position: 'relative',\n      width: 0, height: 0\n    },\n    '[jax=\"SVG\"] mjx-tool > mjx-tip': {\n      position: 'absolute',\n      top: 0, left: 0\n    },\n    'mjx-tool > mjx-tip': {\n      display: 'inline-block',\n      padding: '.2em',\n      border: '1px solid #888',\n      'font-size': '70%',\n      'background-color': '#F8F8F8',\n      color: 'black',\n      'box-shadow': '2px 2px 5px #AAAAAA'\n    },\n    'g[data-mml-node=\"maction\"][data-toggle]': {\n      cursor: 'pointer'\n    },\n    'mjx-status': {\n      display: 'block',\n      position: 'fixed',\n      left: '1em',\n      bottom: '1em',\n      'min-width': '25%',\n      padding: '.2em .4em',\n      border: '1px solid #888',\n      'font-size': '90%',\n      'background-color': '#F8F8F8',\n      color: 'black'\n    }\n  };\n\n  /**\n   * The valid action types and their handlers\n   */\n  public static actions = new Map([\n    ['toggle', [(node, _data) => {\n      //\n      // Mark which child is selected\n      //\n      node.adaptor.setAttribute(node.element, 'data-toggle', node.node.attributes.get('selection') as string);\n      //\n      // Cache the data needed to select another node\n      //\n      const math = node.factory.jax.math;\n      const document = node.factory.jax.document;\n      const mml = node.node as MmlMaction;\n      //\n      // Add a click handler that changes the selection and rerenders the expression\n      //\n      node.setEventHandler('click', (event: Event) => {\n        if (!math.end.node) {\n          //\n          // If the MathItem was created by hand, it might not have a node\n          // telling it where to replace the existing math, so set it.\n          //\n          math.start.node = math.end.node = math.typesetRoot;\n          math.start.n = math.end.n = 0;\n        }\n        mml.nextToggleSelection();\n        math.rerender(document);\n        event.stopPropagation();\n      });\n    }, {}]],\n\n    ['tooltip', [(node, data) => {\n      const tip = node.childNodes[1];\n      if (!tip) return;\n      const rect = node.firstChild();\n      if (tip.node.isKind('mtext')) {\n        //\n        // Text tooltips are handled through title attributes\n        //\n        const text = (tip.node as TextNode).getText();\n        node.adaptor.insert(node.svg('title', {}, [node.text(text)]), rect);\n      } else {\n        //\n        // Math tooltips are handled through hidden nodes and event handlers\n        //\n        const adaptor = node.adaptor;\n        const container = node.jax.container;\n        const math = (node.node as AbstractMmlNode).factory.create('math', {}, [node.childNodes[1].node]);\n        const tool = node.html('mjx-tool', {}, [node.html('mjx-tip')]);\n        const hidden = adaptor.append(rect, node.svg('foreignObject', {style: {display: 'none'}}, [tool]));\n        node.jax.processMath(math, adaptor.firstChild(tool));\n        node.childNodes[1].node.parent = node.node;\n        //\n        // Set up the event handlers to display and remove the tooltip\n        //\n        node.setEventHandler('mouseover', (event: Event) => {\n          data.stopTimers(node, data);\n          data.hoverTimer.set(node, setTimeout(() => {\n            adaptor.setStyle(tool, 'left', '0');\n            adaptor.setStyle(tool, 'top', '0');\n            adaptor.append(container, tool);\n            const tbox = adaptor.nodeBBox(tool);\n            const nbox = adaptor.nodeBBox(node.element);\n            const dx = (nbox.right - tbox.left) / node.metrics.em + node.dx;\n            const dy = (nbox.bottom - tbox.bottom) / node.metrics.em + node.dy;\n            adaptor.setStyle(tool, 'left', node.px(dx));\n            adaptor.setStyle(tool, 'top', node.px(dy));\n          }, data.postDelay));\n          event.stopPropagation();\n        });\n        node.setEventHandler('mouseout',  (event: Event) => {\n          data.stopTimers(node, data);\n          const timer = setTimeout(() => adaptor.append(hidden, tool), data.clearDelay);\n          data.clearTimer.set(node, timer);\n          event.stopPropagation();\n        });\n      }\n    }, TooltipData]],\n\n    ['statusline', [(node, data) => {\n      const tip = node.childNodes[1];\n      if (!tip) return;\n      if (tip.node.isKind('mtext')) {\n        const adaptor = node.adaptor;\n        const text = (tip.node as TextNode).getText();\n        adaptor.setAttribute(node.element, 'data-statusline', text);\n        //\n        // Set up event handlers to change the status window\n        //\n        node.setEventHandler('mouseover', (event: Event) => {\n          if (data.status === null) {\n            const body = adaptor.body(adaptor.document);\n            data.status = adaptor.append(body, node.html('mjx-status', {}, [node.text(text)]));\n          }\n          event.stopPropagation();\n        });\n        node.setEventHandler('mouseout', (event: Event) => {\n          if (data.status) {\n            adaptor.remove(data.status);\n            data.status = null;\n          }\n          event.stopPropagation();\n        });\n      }\n    }, {\n      status: null  // cached status line\n    }]]\n\n  ] as ActionDef<SVGmaction<any, any, any>>[]);\n\n  /*************************************************************/\n\n  /**\n   * @override\n   */\n  public toSVG(parent: N) {\n    const svg = this.standardSVGnode(parent);\n    const child = this.selected;\n    const {h, d, w} = child.getBBox();\n    this.adaptor.append(this.element, this.svg('rect', {\n      width: this.fixed(w), height: this.fixed(h + d), y: this.fixed(-d),\n      fill: 'none', 'pointer-events': 'all'\n    }));\n    child.toSVG(svg);\n    this.action(this, this.data);\n  }\n\n  /**\n   * Add an event handler to the output for this maction\n   */\n  public setEventHandler(type: string, handler: EventHandler) {\n    (this.element as any).addEventListener(type, handler);\n  }\n\n}\n"]},"metadata":{},"sourceType":"script"}